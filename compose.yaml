services:
  server:
    env_file:
      - ./.env
    build:
      context: ./server/

      args:
        - CLIENT_PORT=${CLIENT_PORT}
        - CLIENT_DOMAIN=${CLIENT_DOMAIN}
        - IS_HTTPS=${IS_HTTPS}
        - ROOM_PER_SESSION=${ROOM_PER_SESSION}
        - USER_PER_ROOM=${USER_PER_ROOM}
    ports:
      - ${SERVER_PORT}:8080

  client:
    build:
      context: ./client/
      args:
        - SERVER_DOMAIN=${SERVER_DOMAIN}
        - SERVER_PORT=${SERVER_PORT}
        - CLIENT_PORT=${CLIENT_PORT}
        - IS_HTTPS=${IS_HTTPS}
        - ROOM_PER_SESSION=${ROOM_PER_SESSION}
        - USER_PER_ROOM=${USER_PER_ROOM}
    depends_on:
      - server
    env_file:
      - ./.env
    ports:
      - ${CLIENT_PORT}:80
